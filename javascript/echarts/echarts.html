<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<div style="width: 500px;height: 500px;background-color: black" id="myCharts">

</div>
<script src="companyData.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/echarts/4.9.0-rc.1/echarts.min.js"></script>
<script>
  console.log(15, echarts)
  let currentMap = 'zhongguo'
  //点
  const points = [{
    name: '深水港',
    value: [121.933898, 30.867425]
  }]

  echarts.registerMap('zhongguo', chineseData)
  echarts.registerMap('shanghai', shanghaiData)
  echarts.registerMap('pudong', pudongData)

  let myCharts = echarts.init(document.querySelector('#myCharts'))
  console.log(2119, myCharts)

  const levelColorMap = ['rgba(241, 109, 115, .8)',
    'rgb(255,235,59)',
    'rgba(147, 235, 248)'
  ]

  const option = {
    backgroundColor: '',
    tooltip: {
      trigger: 'item'
    },
    geo: { //地图相关行为
      //silent: true,
      map: 'zhongguo',
      show: false,
      //zoom: 0.8,
      //top: '0%',
      label: {
        normal: {
          show: true,
          textStyle: {
            color: '#fff'
          }
        },
        emphasis: {
          show: false,
          textStyle: {
            color: '#fff'
          }
        }
      },

      roam: false,
      itemStyle: {
        emphasis: {
          color: 'transparent', //悬浮背景
          textStyle: {
            color: '#fff'
          }
        }
      }
    },
    series: [
      {
        map: 'zhongguo',
        type: 'map',
        //zoom: 1.14,
        label: {
          normal: {
            show: false,
            textStyle: {
              color: '#fff'
            }
          },
          emphasis: {
            textStyle: {
              color: '#fff'
            }
          }
        },
        //top: '14%',
        tooltip: {
          show: false
        },
        roam: false,
        itemStyle: {
          normal: {
            areaColor: 'transparent',
            borderColor: '#01f3f6',
            borderWidth: 1,
          },
          emphasis: {
            areaColor: `rgba(1, 243, 246, .4)`,
            textStyle: {
              color: 'white'
            }
          }
        }
      },
      {
        type: 'effectScatter',   //  指明图表类型：带涟漪效果的散点图
        coordinateSystem: 'geo', //  指明绘制在geo坐标系上
        showEffectOn: 'render',
        legendHoverLink:true,       //是否启用图例 hover 时的联动高亮
        hoverAnimation:true,        //是否开启鼠标 hover 的提示动画效果
        rippleEffect: {
          period: 2, //速度
          scale: 6, //缩放
          brushType: 'stroke' //stroke fill
        },
        data: [],
        itemStyle: {
          normal: {
            color: params => {
              return levelColorMap[Math.floor(Math.random() * 3)]
            },
            shadowBlur: 10,
            shadowColor: '#333'
          }
        },
        tooltip: {
          show: true,
          trigger: 'item',
          formatter(val) {
            //console.log(val.data.name)
            return val.data.name
          }
        },
      },
    ]
  }


  myChart = echarts.init(document.querySelector('#myCharts'))

  myCharts.setOption(option)
  // 配置不同级别的地图名称、缩放级别、动画时长
  const MAP_CONFIG = [
    {
      map: 'zhongguo',
      zoom: 1,
      animationDuration: 1000
    },
    {
      map: 'shanghai',
      zoom: 1,
      animationDuration: 1000
    },
    {
      map: 'pudong',
      zoom: 1,
      animationDuration: 1000
    }
  ]

  // 切换地图
  function switchMap(mapConfig) {
    currentMap = mapConfig.map
    // 先缩小地图
    myChart.setOption({
      geo: {
        map: mapConfig.map,
        zoom: 0.01
      },
      series: [{
        map: mapConfig.map,
        zoom: 0.01
      }],
      animationDurationUpdate: 0
    })
    // 再放大地图
    myChart.setOption({
      geo: {
        zoom: 1
      },
      series: [{
        zoom: 1,
      }],
      animationDurationUpdate: 1000
    })
  }

  let i = 0;
  setInterval(() => {
    if (i === MAP_CONFIG.length) {
      i = 0;
    }
    switchMap(MAP_CONFIG[i]);
    i++;
  }, 2000);


</script>
</body>
</html>
